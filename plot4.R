download.file("https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip", "ED.zip") ## download file
unzip("ED.zip") ## unzip file
NEI <- readRDS("summarySCC_PM25.rds") ## read NEI file
SCC <- readRDS("Source_Classification_Code.rds") ## read SCC file

## Question 4 ##
NEI4 <- NEI ## copy data to NEI4 from NEI for manipulation
NEI4$SCC <- as.numeric(NEI4$SCC) ## convert SCC column from character to numeric
NEI4 <- subset(NEI4, SCC == 10100101 | SCC == 10100102 | SCC == 10100201 | SCC == 10100202 | SCC == 10100203 | SCC == 10100204 | SCC == 10100205 | SCC == 10100211 | SCC == 10100212 | SCC == 10100215 | SCC == 10100217 | SCC == 10100218 | SCC == 10100221 | SCC == 10100222 | SCC == 10100223 | SCC == 10100224 | SCC == 10100225 | SCC == 10100226 | SCC == 10100235 | SCC == 10100237 | SCC == 10100238 | SCC == 10100300 | SCC == 10100301 | SCC == 10100302 | SCC == 10100303 | SCC == 10100304 | SCC == 10100306 | SCC == 10100316 | SCC == 10100317 | SCC == 10100318 | SCC == 10102001 | SCC == 10102018 | SCC == 10200101 | SCC == 10200104 | SCC == 10200107 | SCC == 10200117 | SCC == 10200201 | SCC == 10200202 | SCC == 10200203 | SCC == 10200204 | SCC == 10200205 | SCC == 10200206 | SCC == 10200210 | SCC == 10200212 | SCC == 10200213 | SCC == 10200217 | SCC == 10200218 | SCC == 10200219 | SCC == 10200221 | SCC == 10200222 | SCC == 10200223 | SCC == 10200224 | SCC == 10200225 | SCC == 10200226 | SCC == 10200229 | SCC == 10200300 | SCC == 10200301 | SCC == 10200302 | SCC == 10200303 | SCC == 10200304 | SCC == 10200306 | SCC == 10200307 | SCC == 10300101 | SCC == 10300102 | SCC == 10300103 | SCC == 10300203 | SCC == 10300205 | SCC == 10300206 | SCC == 10300207 | SCC == 10300208 | SCC == 10300209 | SCC == 10300211 | SCC == 10300214 | SCC == 10300216 | SCC == 10300217 | SCC == 10300218 | SCC == 10300221 | SCC == 10300222 | SCC == 10300223 | SCC == 10300224 | SCC == 10300225 | SCC == 10300226 | SCC == 10300300 | SCC == 10300305 | SCC == 10300306 | SCC == 10300307 | SCC == 10300309 | SCC == 10500102 | SCC == 10500202 | SCC == 2101001000 | SCC == 2101002000 | SCC == 2101003000 | SCC == 2102001000 | SCC == 2102002000 | SCC == 2103001000 | SCC == 2103002000 | SCC == 219900100 | SCC == 219900200 | SCC == 219900300, select = c(fips:year)) ## Question 4 - subset coal combustion related data (read SCC file for all coal sources - would use regular expression as a best practice to get this info)
NEI4 <- aggregate(x = NEI4$Emissions, by = list(NEI4$year), FUN = sum) ## Question 4 - aggregate PM2.5 emissions by year for coal combustion related data for plotting 
png(file = "plot4.png", width = 480, height = 480) ## write to .png
plot(NEI4, type="l", xlab="Year", ylab="Total Annual Emissions", main="Trend of Coal Combustion Emissions") ## Question 4 - plot total coal combustion emissions by year
dev.off() ## turn of graphics device